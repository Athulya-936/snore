<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snoring Symphony üéµüò¥</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
            color: white;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            padding: 40px 0;
            background: rgba(0,0,0,0.2);
            border-radius: 20px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.1);
        }

        .header h1 {
            font-size: 3.5rem;
            margin-bottom: 10px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 0 0 20px #fff, 0 0 30px #fff, 0 0 40px #667eea; }
            to { text-shadow: 0 0 10px #fff, 0 0 20px #667eea, 0 0 30px #764ba2; }
        }

        .tagline {
            font-size: 1.2rem;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .comic-strip {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            gap: 10px;
            flex-wrap: wrap;
        }

        .comic-panel {
            width: 150px;
            height: 100px;
            background: white;
            border: 3px solid #000;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            font-weight: bold;
            position: relative;
            animation: bounce 2s infinite;
        }

        .comic-panel:nth-child(2) { animation-delay: 0.5s; }
        .comic-panel:nth-child(3) { animation-delay: 1s; }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            .header h1 {
                font-size: 2.5rem;
            }
        }

        .card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            border: 2px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 15px 50px rgba(31, 38, 135, 0.5);
        }

        .card h2 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .record-section {
            text-align: center;
        }

        .record-btn {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: none;
            background: radial-gradient(circle, #ff6b6b, #ee5a24);
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
            margin: 20px 0;
        }

        .record-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 35px rgba(255, 107, 107, 0.6);
        }

        .record-btn.recording {
            animation: pulse 1s infinite;
            background: radial-gradient(circle, #ff4757, #c23616);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .upload-area {
            border: 3px dashed rgba(255,255,255,0.5);
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 20px 0;
        }

        .upload-area:hover {
            border-color: #fff;
            background: rgba(255,255,255,0.1);
        }

        .music-genres {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .genre-btn {
            padding: 15px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            color: white;
        }

        .jazz { background: linear-gradient(45deg, #f39c12, #e67e22); }
        .rap { background: linear-gradient(45deg, #2c3e50, #34495e); }
        .horror { background: linear-gradient(45deg, #8e44ad, #9b59b6); }
        .classical { background: linear-gradient(45deg, #3498db, #2980b9); }
        .western { background: linear-gradient(45deg, #e74c3c, #c0392b); }

        .genre-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        .genre-btn.selected {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(255,255,255,0.8);
        }

        .gallery {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            border: 2px solid rgba(255,255,255,0.2);
        }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .gallery-item {
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s ease;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .gallery-item:hover {
            transform: scale(1.05);
        }

        .play-btn {
            background: linear-gradient(45deg, #00d4aa, #00b894);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            margin: 10px 5px;
            transition: all 0.3s ease;
        }

        .play-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,212,170,0.4);
        }

        .social-share {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .social-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            color: white;
            transition: all 0.3s ease;
            font-size: 0.8rem;
        }

        .whatsapp { background: #25D366; }
        .instagram { background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888); }
        .youtube { background: #FF0000; }

        .social-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .leaderboard {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            border: 2px solid rgba(255,255,255,0.2);
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            gap: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 15px;
            margin: 10px 0;
            transition: transform 0.3s ease;
        }

        .leaderboard-item:hover {
            transform: translateX(10px);
        }

        .winner-meme {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .remix-mode {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            border: 2px solid rgba(255,255,255,0.2);
            text-align: center;
        }

        .remix-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .remix-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 20px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .remix-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .meme-section {
            text-align: center;
            margin: 30px 0;
        }

        .meme-generator {
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }

        .floating-emojis {
            position: fixed;
            font-size: 2rem;
            animation: float 6s ease-in-out infinite;
            pointer-events: none;
            z-index: -1;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        .audio-visualizer {
            width: 100%;
            height: 100px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            margin: 20px 0;
            display: flex;
            align-items: end;
            justify-content: center;
            gap: 3px;
            padding: 10px;
        }

        .bar {
            width: 8px;
            background: linear-gradient(to top, #667eea, #764ba2);
            border-radius: 4px;
            animation: visualize 0.5s ease-in-out infinite alternate;
        }

        @keyframes visualize {
            from { height: 10px; }
            to { height: 80px; }
        }

        .status-display {
            text-align: center;
            margin: 20px 0;
            font-size: 1.1rem;
            font-weight: bold;
        }

        .processing-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .processing-content {
            text-align: center;
            color: white;
            font-size: 1.5rem;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255,255,255,0.3);
            border-top: 5px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .audio-controls {
            margin: 10px 0;
        }

        .audio-player {
            width: 100%;
            margin: 10px 0;
        }

        .delete-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border: none;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.8rem;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .delete-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 3px 10px rgba(255,107,107,0.4);
        }

        .stats-section {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .stat-item {
            display: inline-block;
            margin: 10px 20px;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            display: block;
        }
    </style>
</head>
<body>
    <div class="floating-emojis" style="top: 10%; left: 10%; animation-delay: 0s;">üò¥</div>
    <div class="floating-emojis" style="top: 20%; right: 15%; animation-delay: 1s;">üéµ</div>
    <div class="floating-emojis" style="bottom: 30%; left: 20%; animation-delay: 2s;">üòÇ</div>
    <div class="floating-emojis" style="top: 60%; right: 10%; animation-delay: 3s;">üé≠</div>

    <div class="processing-overlay" id="processingOverlay">
        <div class="processing-content">
            <div class="spinner"></div>
            <div id="processingText">üéµ Transforming your snore into musical magic... ‚ú®</div>
        </div>
    </div>

    <div class="container">
        <header class="header">
            <h1>üéµ SNORING SYMPHONY üò¥</h1>
            <p class="tagline">Transform your snores into epic musical masterpieces!</p>
            
            <div class="comic-strip">
                <div class="comic-panel">üò¥ SNORE</div>
                <div class="comic-panel">üéµ MIX</div>
                <div class="comic-panel">üòÇ LAUGH</div>
            </div>

            <div class="stats-section">
                <div class="stat-item">
                    <span class="stat-number" id="totalSnores">247</span>
                    <span>Total Snores</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="totalShares">1,423</span>
                    <span>Social Shares</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="totalLaughs">8,956</span>
                    <span>Laughs Generated</span>
                </div>
            </div>
        </header>

        <div class="main-content">
            <div class="card">
                <h2>üéôÔ∏è Snore Recorder</h2>
                <div class="record-section">
                    <button class="record-btn" id="recordBtn">
                        <div>üéôÔ∏è<br>START</div>
                    </button>
                    <div class="audio-visualizer" id="visualizer" style="display: none;">
                        <div class="bar" style="animation-delay: 0.1s;"></div>
                        <div class="bar" style="animation-delay: 0.2s;"></div>
                        <div class="bar" style="animation-delay: 0.3s;"></div>
                        <div class="bar" style="animation-delay: 0.4s;"></div>
                        <div class="bar" style="animation-delay: 0.5s;"></div>
                        <div class="bar" style="animation-delay: 0.6s;"></div>
                        <div class="bar" style="animation-delay: 0.7s;"></div>
                        <div class="bar" style="animation-delay: 0.8s;"></div>
                    </div>
                    <div class="status-display" id="status">Ready to record your epic snore!</div>
                    <div class="audio-controls" id="recordedAudioControls" style="display: none;">
                        <audio class="audio-player" id="recordedAudio" controls></audio>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>üìÅ Upload Snore</h2>
                <div class="upload-area" id="uploadArea">
                    <div>üéµ Drop your snore file here or click to upload!</div>
                    <input type="file" id="fileInput" accept="audio/*" style="display: none;">
                </div>
                <div class="status-display" id="uploadStatus">No file selected</div>
                <div class="audio-controls" id="uploadedAudioControls" style="display: none;">
                    <audio class="audio-player" id="uploadedAudio" controls></audio>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>üéº Choose Your Musical Style</h2>
            <div class="music-genres">
                <button class="genre-btn jazz" onclick="selectGenre('jazz')">üé∑ JAZZ</button>
                <button class="genre-btn rap" onclick="selectGenre('rap')">üé§ RAP</button>
                <button class="genre-btn horror" onclick="selectGenre('horror')">üëª HORROR</button>
                <button class="genre-btn classical" onclick="selectGenre('classical')">üéª CLASSICAL</button>
                <button class="genre-btn western" onclick="selectGenre('western')">ü§† WESTERN</button>
            </div>
            <div class="status-display" id="genreStatus">Select a genre to create your masterpiece!</div>
        </div>

        <div class="remix-mode">
            <h2>üéõÔ∏è REMIX MODE</h2>
            <p>Mix multiple genres for ultimate comedy chaos!</p>
            <div class="remix-controls">
                <button class="remix-btn" onclick="addToRemix('jazz')">Add Jazz üé∑</button>
                <button class="remix-btn" onclick="addToRemix('rap')">Add Rap üé§</button>
                <button class="remix-btn" onclick="addToRemix('horror')">Add Horror üëª</button>
                <button class="remix-btn" onclick="addToRemix('classical')">Add Classical üéª</button>
                <button class="remix-btn" onclick="addToRemix('western')">Add Western ü§†</button>
            </div>
            <div class="status-display" id="remixStatus">Remix ingredients: None selected</div>
            <button class="remix-btn" style="background: linear-gradient(45deg, #ff6b6b, #ee5a24);" onclick="createRemix()">üé≠ CREATE ULTIMATE REMIX</button>
        </div>

        <div class="gallery">
            <h2>üé≠ Snore Gallery</h2>
            <p>Check out these legendary snore symphonies!</p>
            <div class="gallery-grid" id="galleryGrid">
                <!-- Gallery items will be dynamically added here -->
            </div>
        </div>

        <div class="leaderboard">
            <h2>üèÜ SNORE CHAMPIONS LEADERBOARD</h2>
            <div id="leaderboardList">
                <!-- Leaderboard items will be dynamically populated -->
            </div>
        </div>

        <div class="meme-section">
            <h2>üòÇ MEME GENERATOR</h2>
            <div class="meme-generator">
                <p>Your snore is so loud...</p>
                <p id="memeText">...even your neighbors started snoring in harmony! üò¥üéµ</p>
                <button class="remix-btn" onclick="generateMeme()">üé≠ Generate New Meme</button>
            </div>
        </div>
    </div>

    <script>
        // Backend Simulation - Database and API Layer
        class SnoringSymphonyBackend {
            constructor() {
                this.data = {
                    gallery: [],
                    leaderboard: [],
                    stats: {
                        totalSnores: 247,
                        totalShares: 1423,
                        totalLaughs: 8956
                    },
                    users: new Map()
                };
                this.initializeDefaultData();
            }

            initializeDefaultData() {
                // Initialize with some sample data
                this.data.gallery = [
                    {
                        id: '1',
                        name: 'Midnight Jazz Snore',
                        genre: 'jazz',
                        creator: 'SleepyJazzLover',
                        plays: 542,
                        likes: 89,
                        shares: 34,
                        audioUrl: null,
                        timestamp: new Date('2024-12-01')
                    },
                    {
                        id: '2',
                        name: 'Horror Snore Attack',
                        genre: 'horror',
                        creator: 'NightmareKing',
                        plays: 721,
                        likes: 156,
                        shares: 67,
                        audioUrl: null,
                        timestamp: new Date('2024-12-02')
                    },
                    {
                        id: '3',
                        name: 'Rap Battle Snore',
                        genre: 'rap',
                        creator: 'SnoreFlow',
                        plays: 389,
                        likes: 92,
                        shares: 28,
                        audioUrl: null,
                        timestamp: new Date('2024-12-03')
                    }
                ];

                this.data.leaderboard = [
                    { position: 1, name: 'SnoreKing2025', track: 'The Thunderous Classical', genre: 'classical', score: 2847, meme: 'üëë' },
                    { position: 2, name: 'SleepyMcSnoreface', track: 'Jazz Fusion Madness', genre: 'jazz', score: 2134, meme: 'ü•à' },
                    { position: 3, name: 'NightNoiseNinja', track: 'Western Showdown', genre: 'western', score: 1823, meme: 'ü•â' }
                ];
            }

            // API Methods
            async uploadSnore(audioBlob, metadata) {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const id = Date.now().toString();
                        const audioUrl = URL.createObjectURL(audioBlob);
                        resolve({ success: true, audioUrl, id });
                    }, 1000);
                });
            }

            async transformAudio(audioUrl, genre, remixGenres = []) {
                return new Promise((resolve) => {
                    const processingTime = remixGenres.length > 0 ? 4000 : 3000;
                    
                    setTimeout(() => {
                        const trackName = this.generateTrackName(genre, remixGenres);
                        const transformedUrl = audioUrl; // In real app, this would be processed audio
                        
                        const newTrack = {
                            id: Date.now().toString(),
                            name: trackName,
                            genre: remixGenres.length > 0 ? 'remix' : genre,
                            genres: remixGenres.length > 0 ? remixGenres : [genre],
                            creator: 'You',
                            plays: 0,
                            likes: 0,
                            shares: 0,
                            audioUrl: transformedUrl,
                            timestamp: new Date()
                        };

                        this.data.gallery.unshift(newTrack);
                        this.updateStats();
                        
                        resolve({ 
                            success: true, 
                            track: newTrack,
                            message: `üéâ SUCCESS! Created: "${trackName}" - Ready to share! üöÄ`
                        });
                    }, processingTime);
                });
            }

            generateTrackName(genre, remixGenres = []) {
                if (remixGenres.length > 0) {
                    return `Ultimate ${remixGenres.join('-').toUpperCase()} Chaos Symphony`;
                }

                const names = {
                    jazz: ["Smooth Snore Serenade", "Midnight Snore Blues", "Bebop Bedroom Beat", "Cool Cat Snore", "Jazzy Sleepy Time"],
                    rap: ["Snore Flow Supreme", "Sleep Rap Battle", "Bedtime Bars & Beats", "MC Sleepy's Drop", "Snore Cypher"],
                    horror: ["Nightmare Snore Symphony", "Terror in the Bedroom", "Haunted Sleep Sounds", "Demon Snore", "Scary Sleep"],
                    classical: ["Snore Symphony No. 9", "The Sleeping Beauty Overture", "Nocturne for Nostrils", "Beethoven's Dream", "Mozart's Sleep"],
                    western: ["Cowboy's Lullaby", "Wild West Sleep Sounds", "Snore on the Range", "Sheriff's Slumber", "Desert Dream"]
                };
                return names[genre][Math.floor(Math.random() * names[genre].length)];
            }

            async shareToSocial(trackId, platform) {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const track = this.data.gallery.find(t => t.id === trackId);
                        if (track) {
                            track.shares++;
                            this.updateStats();
                        }

                        const messages = {
                            whatsapp: `üéµ Check out my epic snore symphony "${track?.name}"! Made with Snoring Symphony! üò¥üé≠ #SnoreArt`,
                            instagram: `Just turned my snore into a ${track?.genre?.toUpperCase()} masterpiece! üéµüòÇ #SnoringSymphony #EpicSnores #SleepMusic`,
                            youtube: `My LEGENDARY ${track?.genre?.toUpperCase()} snore transformation: "${track?.name}"! üéµüëë Created with Snoring Symphony!`
                        };

                        resolve({
                            success: true,
                            platform,
                            message: messages[platform],
                            shareUrl: `https://snoringsymphony.com/track/${trackId}`
                        });
                    }, 500);
                });
            }

            async updateLeaderboard(trackName, genre, score = null) {
                const newScore = score || Math.floor(Math.random() * 1000) + 500;
                const newEntry = {
                    position: this.data.leaderboard.length + 1,
                    name: 'You',
                    track: trackName,
                    genre: genre,
                    score: newScore,
                    meme: this.getRandomMemeEmoji()
                };

                this.data.leaderboard.push(newEntry);
                this.data.leaderboard.sort((a, b) => b.score - a.score);
                
                // Update positions
                this.data.leaderboard.forEach((entry, index) => {
                    entry.position = index + 1;
                });

                return newEntry;
            }

            getRandomMemeEmoji() {
                const memes = ['ü§™', 'üòÇ', 'üé≠', 'üé™', 'ü¶Ñ', 'üöÄ', '‚≠ê', 'üí´', 'üéØ', 'üî•'];
                return memes[Math.floor(Math.random() * memes.length)];
            }

            updateStats() {
                this.data.stats.totalSnores++;
                this.data.stats.totalLaughs += Math.floor(Math.random() * 50) + 10;
            }

            getGallery() {
                return this.data.gallery.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            }

            getLeaderboard() {
                return this.data.leaderboard;
            }

            getStats() {
                return this.data.stats;
            }

            async deleteTrack(trackId) {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        this.data.gallery = this.data.gallery.filter(track => track.id !== trackId);
                        resolve({ success: true });
                    }, 500);
                });
            }

            async likeTrack(trackId) {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const track = this.data.gallery.find(t => t.id === trackId);
                        if (track) {
                            track.likes++;
                            this.updateStats();
                        }
                        resolve({ success: true, likes: track?.likes || 0 });
                    }, 300);
                });
            }
        }

        // Frontend Application
        class SnoringSymphonyApp {
            constructor() {
                this.backend = new SnoringSymphonyBackend();
                this.isRecording = false;
                this.mediaRecorder = null;
                this.audioChunks = [];
                this.selectedGenre = null;
                this.remixGenres = [];
                this.recordedAudio = null;
                this.uploadedAudio = null;
                
                this.memes = [
                    "...NASA thought it was a rocket launch! üöÄ",
                    "...the earthquake department called to check! üåç",
                    "...your neighbors moved to another country! üèÉ‚Äç‚ôÇÔ∏è",
                    "...even hibernating bears woke up! üêª",
                    "...it registered on the Richter scale! üìä",
                    "...aliens thought it was a communication signal! üëΩ",
                    "...thunder got jealous! ‚ö°",
                    "...the ocean waves got scared! üåä",
                    "...even zombies couldn't sleep! üßü‚Äç‚ôÇÔ∏è",
                    "...it became a new alarm clock standard! ‚è∞",
                    "...seismologists reported a new kind of tremor! üåã",
                    "...your pet started wearing earplugs! üêï",
                    "...the Wi-Fi signal got disrupted! üì∂",
                    "...even construction workers took a break! üë∑‚Äç‚ôÇÔ∏è",
                    "...birds started migrating in December! ü¶Ö"
                ];

                this.init();
            }

            init() {
                this.setupEventListeners();
                this.loadInitialData();
                this.updateStatsDisplay();
                this.startRandomMemeGeneration();
            }

            setupEventListeners() {
                // Record button
                document.getElementById('recordBtn').addEventListener('click', () => this.toggleRecording());

                // Upload area
                const uploadArea = document.getElementById('uploadArea');
                const fileInput = document.getElementById('fileInput');
                
                uploadArea.addEventListener('click', () => fileInput.click());
                uploadArea.addEventListener('dragover', this.handleDragOver.bind(this));
                uploadArea.addEventListener('dragleave', this.handleDragLeave.bind(this));
                uploadArea.addEventListener('drop', this.handleFileDrop.bind(this));
                fileInput.addEventListener('change', this.handleFileSelect.bind(this));
            }

            async loadInitialData() {
                this.renderGallery();
                this.renderLeaderboard();
            }

            updateStatsDisplay() {
                const stats = this.backend.getStats();
                document.getElementById('totalSnores').textContent = stats.totalSnores.toLocaleString();
                document.getElementById('totalShares').textContent = stats.totalShares.toLocaleString();
                document.getElementById('totalLaughs').textContent = stats.totalLaughs.toLocaleString();
            }

            startRandomMemeGeneration() {
                setInterval(() => {
                    if (Math.random() < 0.3) { // 30% chance every interval
                        this.generateMeme();
                    }
                }, 15000); // Every 15 seconds
            }

            async toggleRecording() {
                const btn = document.getElementById('recordBtn');
                const status = document.getElementById('status');
                const visualizer = document.getElementById('visualizer');
                const audioControls = document.getElementById('recordedAudioControls');

                if (!this.isRecording) {
                    try {
                        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                        this.mediaRecorder = new MediaRecorder(stream);
                        this.audioChunks = [];

                        this.mediaRecorder.ondataavailable = event => {
                            this.audioChunks.push(event.data);
                        };

                        this.mediaRecorder.onstop = async () => {
                            const audioBlob = new Blob(this.audioChunks, { type: 'audio/wav' });
                            const result = await this.backend.uploadSnore(audioBlob, { source: 'recording' });
                            
                            if (result.success) {
                                this.recordedAudio = result.audioUrl;
                                const audioElement = document.getElementById('recordedAudio');
                                audioElement.src = this.recordedAudio;
                                audioControls.style.display = 'block';
                                status.textContent = "Epic snore recorded! Choose a genre to transform it! üéµ";
                            }
                            visualizer.style.display = 'none';
                        };

                        this.mediaRecorder.start();
                        this.isRecording = true;
                        btn.classList.add('recording');
                        btn.innerHTML = '<div>‚èπÔ∏è<br>STOP</div>';
                        status.textContent = "Recording your legendary snore... üéôÔ∏è";
                        visualizer.style.display = 'flex';
                    } catch (err) {
                        console.error('Error accessing microphone:', err);
                        status.textContent = "Oops! Couldn't access microphone üé§‚ùå";
                    }
                } else {
                    this.mediaRecorder.stop();
                    this.isRecording = false;
                    btn.classList.remove('recording');
                    btn.innerHTML = '<div>üéôÔ∏è<br>START</div>';
                    this.mediaRecorder.stream.getTracks().forEach(track => track.stop());
                }
            }

            handleDragOver(e) {
                e.preventDefault();
                document.getElementById('uploadArea').style.background = 'rgba(255,255,255,0.2)';
            }

            handleDragLeave(e) {
                e.preventDefault();
                document.getElementById('uploadArea').style.background = 'transparent';
            }

            handleFileDrop(e) {
                e.preventDefault();
                document.getElementById('uploadArea').style.background = 'transparent';
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    this.processFile(files[0]);
                }
            }

            handleFileSelect(e) {
                if (e.target.files.length > 0) {
                    this.processFile(e.target.files[0]);
                }
            }

            async processFile(file) {
                const uploadStatus = document.getElementById('uploadStatus');
                const audioControls = document.getElementById('uploadedAudioControls');

                if (file.type.startsWith('audio/')) {
                    const result = await this.backend.uploadSnore(file, { source: 'upload', filename: file.name });
                    
                    if (result.success) {
                        this.uploadedAudio = result.audioUrl;
                        const audioElement = document.getElementById('uploadedAudio');
                        audioElement.src = this.uploadedAudio;
                        audioControls.style.display = 'block';
                        uploadStatus.textContent = `‚úÖ ${file.name} loaded! Ready to transform! üéµ`;
                    }
                } else {
                    uploadStatus.textContent = "‚ùå Please upload an audio file!";
                }
            }

            selectGenre(genre) {
                // Remove previous selection
                document.querySelectorAll('.genre-btn').forEach(btn => btn.classList.remove('selected'));
                
                // Add selection to current genre
                document.querySelector(`.genre-btn.${genre}`).classList.add('selected');
                
                this.selectedGenre = genre;
                const status = document.getElementById('genreStatus');
                
                const currentAudio = this.recordedAudio || this.uploadedAudio;
                if (currentAudio) {
                    this.transformAudio(genre);
                } else {
                    status.textContent = `${genre.toUpperCase()} selected! Record or upload a snore first! üéµ`;
                }
            }

            async transformAudio(genre) {
                const status = document.getElementById('genreStatus');
                const overlay = document.getElementById('processingOverlay');
                const processingText = document.getElementById('processingText');
                
                const currentAudio = this.recordedAudio || this.uploadedAudio;
                if (!currentAudio) {
                    status.textContent = "Please record or upload a snore first! üéôÔ∏è";
                    return;
                }

                // Show processing overlay
                overlay.style.display = 'flex';
                processingText.textContent = `üéµ Transforming your snore into ${genre.toUpperCase()} magic... ‚ú®`;

                try {
                    const result = await this.backend.transformAudio(currentAudio, genre);
                    
                    if (result.success) {
                        status.textContent = result.message;
                        await this.backend.updateLeaderboard(result.track.name, genre);
                        this.renderGallery();
                        this.renderLeaderboard();
                        this.updateStatsDisplay();
                        
                        // Show success animation
                        this.showSuccessAnimation(result.track.name);
                    }
                } catch (error) {
                    status.textContent = "‚ùå Something went wrong during transformation!";
                } finally {
                    overlay.style.display = 'none';
                }
            }

            addToRemix(genre) {
                if (!this.remixGenres.includes(genre)) {
                    this.remixGenres.push(genre);
                    document.getElementById('remixStatus').textContent = 
                        `Remix ingredients: ${this.remixGenres.map(g => g.toUpperCase()).join(', ')} üé≠`;
                }
            }

            async createRemix() {
                const remixStatus = document.getElementById('remixStatus');
                
                if (this.remixGenres.length < 2) {
                    remixStatus.textContent = "Add at least 2 genres for ultimate chaos! üé™";
                    return;
                }
                
                const currentAudio = this.recordedAudio || this.uploadedAudio;
                if (!currentAudio) {
                    remixStatus.textContent = "Record or upload a snore first! üéôÔ∏è";
                    return;
                }

                const overlay = document.getElementById('processingOverlay');
                const processingText = document.getElementById('processingText');
                
                overlay.style.display = 'flex';
                processingText.textContent = "üé≠ Creating the most chaotic snore remix ever... Hold on! üå™Ô∏è";

                try {
                    const result = await this.backend.transformAudio(currentAudio, 'remix', this.remixGenres);
                    
                    if (result.success) {
                        remixStatus.textContent = `üéâ REMIX COMPLETE: "${result.track.name}" - This is LEGENDARY! üëë`;
                        await this.backend.updateLeaderboard(result.track.name, 'remix');
                        this.renderGallery();
                        this.renderLeaderboard();
                        this.updateStatsDisplay();
                        this.remixGenres = [];
                        
                        this.showSuccessAnimation(result.track.name);
                    }
                } catch (error) {
                    remixStatus.textContent = "‚ùå Remix failed! Try again!";
                } finally {
                    overlay.style.display = 'none';
                }
            }

            showSuccessAnimation(trackName) {
                // Create floating success message
                const successMsg = document.createElement('div');
                successMsg.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: linear-gradient(45deg, #00d4aa, #00b894);
                    color: white;
                    padding: 20px;
                    border-radius: 15px;
                    font-size: 1.2rem;
                    font-weight: bold;
                    z-index: 1001;
                    animation: successPop 3s ease-in-out forwards;
                    box-shadow: 0 10px 30px rgba(0,212,170,0.5);
                `;
                successMsg.textContent = `üéâ "${trackName}" created successfully! üöÄ`;
                
                // Add animation keyframes
                if (!document.getElementById('successAnimation')) {
                    const style = document.createElement('style');
                    style.id = 'successAnimation';
                    style.textContent = `
                        @keyframes successPop {
                            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
                            20% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
                            80% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
                            100% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
                        }
                    `;
                    document.head.appendChild(style);
                }
                
                document.body.appendChild(successMsg);
                
                setTimeout(() => {
                    document.body.removeChild(successMsg);
                }, 3000);
            }

            renderGallery() {
                const gallery = this.backend.getGallery();
                const galleryGrid = document.getElementById('galleryGrid');
                
                galleryGrid.innerHTML = gallery.map(track => {
                    const genreEmojis = {
                        jazz: "üé∑", rap: "üé§", horror: "üëª", 
                        classical: "üéª", western: "ü§†", remix: "üé≠"
                    };
                    
                    return `
                        <div class="gallery-item" data-track-id="${track.id}">
                            <h3>${genreEmojis[track.genre] || 'üéµ'} ${track.name}</h3>
                            <p>By: ${track.creator}</p>
                            <p>üéß ${track.plays} plays ‚Ä¢ ‚ù§Ô∏è ${track.likes} likes ‚Ä¢ üì§ ${track.shares} shares</p>
                            ${track.audioUrl ? `
                                <audio class="audio-player" controls>
                                    <source src="${track.audioUrl}" type="audio/wav">
                                </audio>
                            ` : ''}
                            <div class="audio-controls">
                                <button class="play-btn" onclick="app.likeTrack('${track.id}')">‚ù§Ô∏è Like</button>
                                ${track.creator === 'You' ? `<button class="delete-btn" onclick="app.deleteTrack('${track.id}')">üóëÔ∏è Delete</button>` : ''}
                            </div>
                            <div class="social-share">
                                <button class="social-btn whatsapp" onclick="app.shareToSocial('${track.id}', 'whatsapp')">WhatsApp</button>
                                <button class="social-btn instagram" onclick="app.shareToSocial('${track.id}', 'instagram')">Instagram</button>
                                <button class="social-btn youtube" onclick="app.shareToSocial('${track.id}', 'youtube')">YouTube</button>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            renderLeaderboard() {
                const leaderboard = this.backend.getLeaderboard();
                const leaderboardList = document.getElementById('leaderboardList');
                
                leaderboardList.innerHTML = leaderboard.map((entry, index) => {
                    const backgrounds = [
                        'linear-gradient(45deg, #ffd700, #ffed4e)',
                        'linear-gradient(45deg, #c0c0c0, #e5e5e5)',
                        'linear-gradient(45deg, #cd7f32, #daa520)',
                        'rgba(255,255,255,0.1)'
                    ];
                    const textColors = ['color: #333;', 'color: #333;', 'color: white;', 'color: white;'];
                    
                    return `
                        <div class="leaderboard-item" style="background: ${backgrounds[index] || backgrounds[3]}; ${textColors[index] || textColors[3]}">
                            <div class="winner-meme">${entry.meme}</div>
                            <div>
                                <h3>${entry.position === 1 ? 'ü•á' : entry.position === 2 ? 'ü•à' : entry.position === 3 ? 'ü•â' : 'üèÖ'} ${entry.name} - "${entry.track}"</h3>
                                <p>${entry.genre.toUpperCase()} ‚Ä¢ Score: ${entry.score.toLocaleString()} points</p>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            async shareToSocial(trackId, platform) {
                try {
                    const result = await this.backend.shareToSocial(trackId, platform);
                    
                    if (result.success) {
                        // Show share dialog
                        const shareText = `Sharing to ${platform.toUpperCase()}!\n\n"${result.message}"\n\nüöÄ Link: ${result.shareUrl}`;
                        alert(shareText);
                        
                        // Update gallery display
                        this.renderGallery();
                        this.updateStatsDisplay();
                        
                        // Increment global shares
                        this.backend.data.stats.totalShares++;
                    }
                } catch (error) {
                    alert(`Failed to share to ${platform}. Please try again!`);
                }
            }

            async deleteTrack(trackId) {
                if (confirm('Are you sure you want to delete this masterpiece?')) {
                    try {
                        const result = await this.backend.deleteTrack(trackId);
                        if (result.success) {
                            this.renderGallery();
                            alert('Track deleted successfully! üóëÔ∏è');
                        }
                    } catch (error) {
                        alert('Failed to delete track. Please try again!');
                    }
                }
            }

            async likeTrack(trackId) {
                try {
                    const result = await this.backend.likeTrack(trackId);
                    if (result.success) {
                        this.renderGallery();
                        this.updateStatsDisplay();
                    }
                } catch (error) {
                    console.error('Failed to like track:', error);
                }
            }

            generateMeme() {
                const memeText = document.getElementById('memeText');
                const randomMeme = this.memes[Math.floor(Math.random() * this.memes.length)];
                memeText.textContent = randomMeme;
                
                // Add a little animation
                memeText.style.transform = 'scale(1.1)';
                memeText.style.transition = 'transform 0.3s ease';
                setTimeout(() => {
                    memeText.style.transform = 'scale(1)';
                }, 300);
            }
        }

        // Initialize the application
        let app;
        document.addEventListener('DOMContentLoaded', () => {
            app = new SnoringSymphonyApp();
        });

        // Global functions for onclick handlers
        function selectGenre(genre) {
            app.selectGenre(genre);
        }

        function addToRemix(genre) {
            app.addToRemix(genre);
        }

        function createRemix() {
            app.createRemix();
        }

        function generateMeme() {
            app.generateMeme();
        }

        // Auto-update stats periodically
        setInterval(() => {
            if (app) {
                app.updateStatsDisplay();
            }
        }, 30000); // Every 30 seconds
    </script>
</body>
</html>